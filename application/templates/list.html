{% extends "base.html" %}

{% block imports %}
    <script>
        function start_editing() {
            // Enables the checkboxes and the controls
            for (i of document.getElementsByTagName('input')) { i.disabled = false; i.checked = false; }
            for (i of document.getElementsByClassName('non-editing')) i.style.display = 'none';
            for (i of document.getElementsByClassName('editing')) i.style.display = 'block';
        }

        function abort() {
            // Disables the checkboxes and the controls
            for (i of document.getElementsByTagName('input')) { i.disabled = true; i.checked = false; }
            for (i of document.getElementsByClassName('non-editing')) i.style.display = 'block';
            for (i of document.getElementsByClassName('editing')) i.style.display = 'none';
        }

        function submit() {
            document.forms[0].submit();
        }

        window.onload = abort;
    </script>
{% endblock %}

{% block content %}
    <h1>Lista della spesa</h1>

    <form method="POST">
        {% for i in items %}
            <div>
                <input type="checkbox" id="{{ i[0] }}" name="{{ i[0] }}">
                <label for="{{ i[0] }}">{{ i[1] }}</label>
            </div>
        {% else %}
            <i>La lista della spesa &egrave; vuota.</i>
        {% endfor %}

        <a href="add" class="non-editing button">Aggiungi prodotti</a>
        <a href="javascript:start_editing()" class="non-editing button">Rimuovi prodotti</a>

        <a href="javascript:abort()" class="editing button">Annulla</a>
        <a href="javascript:submit()" class="editing button">Salva</a>
    </form>
{% endblock %}
