{% extends "base.html" %}


{% set title = 'Rimuovi articoli' %}

{% block imports %}
    <script>
        window.onload = function() { for (input of $('.expiration')) input.value = new Date(input.value).toLocaleDateString(); }

        function saveData() {
            var data = "";
            for (c of $('input[type=checkbox]:checked')) data += c.id.slice(4) + ';';
            $('#data').val(data.slice(0, -1));
        }
    </script>
{% endblock %}

{% block content %}
    <form method="POST" autocomplete="off">
        <div class="buttons-line">
            <button title="Annulla" class="icon" onclick="location.href='.';" type="button"><i class="fas fa-undo"></i></button>
            <button title="Conferma" class="icon" onclick="saveData();"><i class="fas fa-check"></i></button>
        </div>

        <div>
            {% if not storage %}
                <i>La lista &egrave; vuota.</i>
            {% else %}
                {% for item in storage %}
                    <div>
                        <input type="checkbox" id="aid-{{ item.aid }}">
                        <label for="aid-{{ item.aid }}" class="item">
                            <input class="name" value="{{ item.name }}" readonly>
                            {% if item.expiration %} <input class="expiration" value="{{ item.expiration }}" readonly> {% endif %}
                            {% if item.quantity %} <input class="quantity" value="{{ item.quantity }}" readonly> {% endif %}
                        </label>
                    </div>
                {% endfor %}
            {% endif %}
        </div>

        <input id="data" name="data" hidden>
    </form>
{% endblock %}
