{% extends "templates/base.html" %}

{% set title = "Modifica menù" %}

{% set back_link = '/menu/' + str(menu.mid) %}

{% block imports %}
    <script>
        function remove() {
            var f = document.forms[0];
            f.action = f.action.replace('modifica', 'elimina');
            f.submit();
        }

        function save() {
            var data = "";
            for (var i = 0; i < 14; i++) data += $('#entry-' + i).val() + ';';
            $('#data').val(data.slice(0, -1));
        }
    </script>
{% endblock %}

{% block content %}
    <form method="POST" autocomplete="off">
        <textarea id="data" name="data" hidden></textarea>

        <div class="menu-day">
            <b>Nome</b> <br>
            <input type="text" value="{{ menu.mid }}">
        </div>

        <br>

        {% set i = namespace(d=0) %}
        {% set entries = menu.menu.split(';') %}
        {% for day_name in ["Lunedì", "Martedì", "Mercoledì", "Giovedì", "Venerdì", "Sabato", "Domenica"] %}
            <div class="menu-day">
                <b>{{ day_name }}</b>
                <textarea id="entry-{{ i.d }}">{{ entries[i.d] }}</textarea> {% set i.d = i.d + 1 %}
                <textarea id="entry-{{ i.d }}">{{ entries[i.d] }}</textarea> {% set i.d = i.d + 1 %}
            </div>
        {% endfor %}

        <button title="Elimina" class="icon-text" onclick="showConfirm('Sei sicuro di voler eliminare questo menù?', remove);" type="button"><i class="fas fa-trash-alt"></i> Elimina menù</button>
        <button title="Conferma" class="icon-text" onclick="save();"><i class="fas fa-check"></i> Salva</button>
    </form>
{% endblock %}
